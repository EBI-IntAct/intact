<?xml version="1.0" encoding="ISO-8859-1" ?>

<!DOCTYPE struts-config PUBLIC
          "-//Apache Software Foundation//DTD Struts Configuration 1.1//EN"
          "http://jakarta.apache.org/struts/dtds/struts-config_1_1.dtd">

<!--
     This is the Struts configuration file for the example application,
     using the proposed new syntax.

     NOTE:  You would only flesh out the details in the "form-bean"
     declarations if you had a generator tool that used them to create
     the corresponding Java classes for you.  Otherwise, you would
     need only the "form-bean" element itself, with the corresponding
     "name" and "type" attributes.
-->


<struts-config>

    <!-- ========== Form Bean Definitions =================================== -->
    <form-beans>

        <!-- The sidebar form -->
        <form-bean name="sidebarForm"
                   type="org.apache.struts.action.DynaActionForm">
            <form-property name="searchString" initial="*" type="java.lang.String"/>
            <form-property name="searchClass" type="java.lang.String"/>
        </form-bean>

        <!-- Search form bean -->
        <form-bean name="viewForm"
                   type="uk.ac.ebi.intact.application.search.struts.view.ViewForm"/>

    </form-beans>

    <!-- ========== Global Forward Definitions ============================== -->
    <global-forwards>
        <!-- Need this global forward from the index.jsp -->
        <forward name="start" path="/do/welcome"/>
        <forward name="failure"  path="error.layout"/>
    </global-forwards>

    <!-- ========== Action Mapping Definitions ============================== -->
    <action-mappings>

        <!-- Process when user clicks on the logo to enter the application. -->
        <action path="/welcome"
                type="uk.ac.ebi.intact.application.search.struts.controller.WelcomeAction"
                scope="request">
            <forward name="success" path="search.layout"/>
        </action>

        <!-- Process when user accesses search via HierarchView application -->
        <action path="/hvWelcome"
                type="uk.ac.ebi.intact.application.search.struts.controller.WelcomeAction"
                scope="request">
            <forward name="success" path="/do/search"/>
        </action>

        <!-- Process a user searches for a CV Object. The form is in a session because
             we reuse search details from view action. Currently once a search has been
             successful, there are a number of options for subsequent processing:
             - generate beans for a detailed view
             - generate a bean for a single object view
             - process requests from a protein view that is different to the main views
             -->
        <action path="/search"
                name="sidebarForm"
                type="uk.ac.ebi.intact.application.search.struts.controller.SearchAction"
                scope="session">
            <forward name="noMatch" path="no.match.layout"/>
            <forward name="results" path="match.layout"/>
            <forward name="sessionLost" path="/do/welcome"/>
            <forward name="detailAction" path="/do/detail"/>
            <forward name="singleItemAction" path="/do/singleItem"/>
        </action>

        <!-- processed when a detailed view is required after a search. This is
            typically accessed from the searchAction rather than a user request
        -->
        <action path="/detail"
                name="viewForm"
                type="uk.ac.ebi.intact.application.search.struts.controller.DetailsAction"
                scope="session">
            <forward name="noMatch" path="no.match.layout"/>
            <forward name="results" path="match.layout"/>
            <forward name="sessionLost" path="/do/welcome"/>
            <forward name="proteinAction" path="/do/protein"/>
        </action>

        <!-- processed when a single object view is required after a search. This is
            typically accessed from the searchAction rather than a user request
        -->
        <action path="/singleItem"
                name="viewForm"
                type="uk.ac.ebi.intact.application.search.struts.controller.SingleItemAction"
                scope="session">
            <forward name="noMatch" path="no.match.layout"/>
            <forward name="results" path="match.layout"/>
            <forward name="sessionLost" path="/do/welcome"/>
        </action>

        <!-- processed when a protein follow-up view is required after a search. This is
            typically accessed from the searchAction rather than a user request
        -->
        <action path="/protein"
                name="viewForm"
                type="uk.ac.ebi.intact.application.search.struts.controller.ProteinAction"
                scope="session">
            <forward name="noMatch" path="no.match.layout"/>
            <forward name="results" path="match.layout"/>
            <forward name="sessionLost" path="/do/welcome"/>
        </action>

        <!-- Process a user selects from a search result. -->
        <action path="/view"
                type="uk.ac.ebi.intact.application.search.struts.controller.ViewAction"
                name="viewForm"
                scope="request">
            <forward name="results" path="match.layout"/>
            <forward name="proteinView" path="/do/search"/>
        </action>

    </action-mappings>

    <!-- ========== Plug Ins Configuration ================================== -->

    <!--
        Add multiple validator resource files by setting the pathnames property
        with a comma delimitted list of resource files to load.
    -->
    <plug-in className="org.apache.struts.tiles.TilesPlugin" >
        <set-property property="definitions-config" value="/WEB-INF/tiles-defs.xml"/>
        <set-property property="moduleAware" value="true" />
    </plug-in>

</struts-config>
