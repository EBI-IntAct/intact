/**
 * Copyright 2008 The European Bioinformatics Institute, and others.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package uk.ac.ebi.intact.psimitab.rsc;

import org.junit.Test;
import org.junit.Assert;

import java.util.Properties;
import java.util.Collections;
import java.util.Arrays;

import uk.ac.ebi.intact.psimitab.IntactDocumentDefinition;
import psidev.psi.mi.tab.model.builder.RowBuilder;
import psidev.psi.mi.tab.model.builder.Row;

/**
 * Test Class for RelevanceScoreCalculator
 *
 * @author Prem Anand (prem@ebi.ac.uk)
 * @version $Id$
 * @since  2.0.2-SNAPSHOT
 */
public class RelevanceScoreCalculatorTest {


    @Test
    public void getRscScoreTestWithEmptyProperties() throws Exception {

        //Protein-Protein interaction with expRoleA=prey expRoleB=bait bioRoleA=unspecified role bioRoleB=unspecified role
        String psiMiTabLine = "uniprotkb:P16884|intact:EBI-446344\tuniprotkb:Q60824|intact:EBI-446159\tuniprotkb:Nefh(gene name)\tuniprotkb:Dst(gene name)\tintact:Nfh\tintact:Bpag1\tMI:0018(2 hybrid)\tLeung et al. (1999)\tpubmed:9971739\ttaxid:10116(rat)\ttaxid:10090(mouse)\tMI:0218(physical interaction)\tMI:0469(intact)\tintact:EBI-446356\t-\tMI:0498(prey)\tMI:0496(bait)\tMI:0499(unspecified role)\tMI:0499(unspecified role)\tinterpro:IPR004829|interpro:IPR010790|interpro:IPR001664|uniprotkb:O35482|rgd:3159|ensembl:ENSRNOG00000008716|uniprotkb:Q540Z7|uniprotkb:Q63368\tgo:0005737|go:0030056|go:0005200|go:0045104|interpro:IPR001589|interpro:IPR001715|interpro:IPR002048|interpro:IPR001101|uniprotkb:Q60845|uniprotkb:Q9WU50|go:0008090|go:0015629|go:0015630|go:0060053|go:0008017|go:0031122|go:0031110|ensembl:ENSMUSG00000026131\tMI:0326(protein)\tMI:0326(protein)\tyeast:4932\t-\t-";

        //String psiMiTabLine = "uniprotkb:P15104|intact:DGI-294111\tchebi:\"CHEBI:16015\"|drugbank:DB00142|intact:DGI-301615|chebi:\"CHEBI:16811\"|drugbank:DB00134|intact:DGI-300873|chebi:\"CHEBI:28300\"|drugbank:DB00130|intact:DGI-300015\tuniprotkb:GLNS(gene name synonym)|uniprotkb:Glutamate--ammonia ligase(gene name synonym)|uniprotkb:glna_human\tintact:\"(2S)-2-Aminopentanedioic acid\"(drug brand name)|intact:\"(S)-(+)-Glutamic acid\"(drug brand name)|intact:\"(S)-2-Aminopentanedioic acid\"(drug brand name)|intact:\"(S)-Glutamic acid\"(drug brand name)|intact:1-Aminopropane-1,3-dicarboxylic acid(drug brand name)|intact:2-Aminoglutaric acid(drug brand name)|intact:2-Aminopentanedioic acid(drug brand name)|intact:a-Glutamic acid(drug brand name)|intact:a-Aminoglutaric acid(drug brand name)|intact:\"L-(+)-Glutamic acid\"(drug brand name)|intact:L-a-Aminoglutaric acid(drug brand name)|intact:L-Glutamate(drug brand name)|intact:L-Glutaminic acid(drug brand name)|intact:Glutaminic acid(drug brand name)|intact:Glutamic acid(drug brand name)|intact:L-Glutamic Acid(commercial name)|intact:Aciglut(drug brand name)|intact:Glusate(drug brand name)|intact:Glutacid(drug brand name)|intact:Glutamicol(drug brand name)|intact:Glutamidex(drug brand name)|intact:Glutaminol(drug brand name)|intact:Glutaton(drug brand name)|intact:\"(S)-2-Amino-4-(methylthio)butanoic acid\"(drug brand name)|intact:\"2-Amino-4-(methylthio)butyric acid\"(drug brand name)|intact:a-Amino-g-methylmercaptobutyric acid(drug brand name)|intact:g-Methylthio-a-aminobutyric acid(drug brand name)|intact:\"L-(-)-Methionine\"(drug brand name)|intact:L-a-Amino-g-methylthiobutyric acid(drug brand name)|intact:Methionine(drug brand name)|intact:L-Methionine(commercial name)|intact:Acimethin(drug brand name)|intact:Cymethion(drug brand name)|intact:2-Aminoglutaramic acid(drug brand name)|intact:Glutamine(drug brand name)|intact:L-Glutamine(commercial name)|intact:\"Glutamine Fuel Powder (Twinlab)\"(drug brand name)|intact:\"Glutamine Fuel Mega (Twinlab)\"(drug brand name)|intact:\"Glutamine Express (Genetic Evolutionary Nutrition)\"(drug brand name)|intact:\"L-Glutamine Power (Champion Nutrition)\"(drug brand name)|intact:\"Earthlink Science Glutamine Chews Chocolate (Amerifit)\"(drug brand name)|intact:Cebrogen(drug brand name)|intact:Stimulina(drug brand name)|intact:Glavamin(drug brand name)\tuniprotkb:GLUL\t-\tpsi-mi:\"MI:0045\"(experimental interac)|psi-mi:\"MI:0045\"(experimental interac)|psi-mi:\"MI:0045\"(experimental interac)|psi-mi:\"MI:0045\"(experimental interac)\t-|-\tpubmed:18048412|pubmed:18048412|pubmed:18048412|pubmed:18048412\ttaxid:9606(human)\ttaxid:-3(unknown)|taxid:-3(unknown)|taxid:-3(unknown)\tpsi-mi:\"MI:0407\"(direct interaction)|psi-mi:\"MI:0407\"(direct interaction)|psi-mi:\"MI:0407\"(direct interaction)|psi-mi:\"MI:0407\"(direct interaction)\tpsi-mi:\"MI:1002\"(DrugBank)|psi-mi:\"MI:1002\"(DrugBank)|psi-mi:\"MI:1002\"(DrugBank)|psi-mi:\"MI:1002\"(DrugBank)\tintact:DGI-301864|intact:DGI-300980|intact:DGI-300148|intact:DGI-300199\t-\tpsi-mi:\"MI:1095\"(drug target)\tpsi-mi:\"MI:1094\"(drug)|psi-mi:\"MI:1094\"(drug)|psi-mi:\"MI:1094\"(drug)|psi-mi:\"MI:0499\"(unspecified role)\tpsi-mi:\"MI:0499\"(unspecified role)\tpsi-mi:\"MI:0499\"(unspecified role)|psi-mi:\"MI:0502\"(enzyme target)|psi-mi:\"MI:0499\"(unspecified role)|psi-mi:\"MI:0501\"(enzyme)\tensembl:ENSG00000135821|rcsb pdb:2OJW|rcsb pdb:2QC8|refseq:NP_001028216.1|refseq:NP_001028228.1|refseq:NP_002056.2|interpro:IPR008147(Glutamine synthetase, beta-Grasp)|interpro:IPR014746(Glutamine synthetase/guanido kinase, catalytic region)|interpro:IPR008146(Glutamine synthetase, catalytic region)|reactome:REACT_13|uniprotkb:Q499Y9(secondary-ac)|uniprotkb:Q5T9Z1(secondary-ac)|uniprotkb:Q7Z3W4(secondary-ac)|uniprotkb:Q8IZ17(secondary-ac)|uniprotkb:P15104(identity)\tdrugbank:NUTR00027(secondary-ac)|pubmed:10736373|pubmed:15939876|pubmed:10736365|pubmed:7901400|pubmed:17202478|rcsb pdb:1BGV|chebi:\"CHEBI:16015\"(L-glutamic acid)|drugbank:DB00142(identity)|drugbank:NUTR00038(secondary-ac)|rcsb pdb:1WKM|chebi:\"CHEBI:16811\"(methionine)|drugbank:DB00134(identity)|drugbank:NUTR00026(secondary-ac)|pubmed:11408280|pubmed:1903318|pubmed:9488531|pubmed:10483898|rcsb pdb:1SG9|chebi:\"CHEBI:28300\"(glutamine)|drugbank:DB00130(identity)\tpsi-mi:\"MI:0326\"(protein)\tpsi-mi:\"MI:0328\"(small molecule)\ttaxid:-3(unknown)|taxid:-3(unknown)|taxid:-3(unknown)|taxid:-3(unknown)\t-\tDrugBank - a knowledgebase for drugs, drug actions and drug targets.|DrugBank - a knowledgebase for drugs, drug actions and drug targets.|DrugBank - a knowledgebase for drugs, drug actions and drug targets.|DrugBank - a knowledgebase for drugs, drug actions and drug targets.\t-\tbiotech prep:A peptide that is a homopolymer of glutamic acid. [PubChem]|drug type:Small Molecule; Nutraceutical; Approved|drug category:Dietary supplement; Micronutrient; Non-Essential Amino Acids|disease indication:\"Considered to be nature's \\\"Brain food\\\" by improving mental capacities; helps speed the healing of ulcers; gives a \\\"lift\\\" from fatigue; helps control alcoholism, schizophrenia and the craving for sugar.\"|pharmacology:In addition to being one of the building blocks in protein synthesis, it is the most widespread neurotransmitter in brain function, as an excitatory neurotransmitter and as a precursor for the synthesis of GABA in GABAergic neurons.|mechanism of action:\"Glutamate activates both ionotropic and metabotropic glutamate receptors. The ionotropic ones being non-NMDA (AMPA and kainate) and NMDA receptors. Free glutamic acid cannot cross the blood-brain barrier in appreciable quantities; instead it is converted into L-glutamine, which the brain uses for fuel and protein synthesis. It is conjectured that glutamate is involved in cognitive functions like learning and memory in the brain, though excessive amounts may cause neuronal damage associated in diseases like amyotrophic lateral sclerosis, lathyrism, and Alzheimer's disease. Also, the drug phencyclidine (more commonly known as PCP) antagonizes glutamate at the NMDA receptor, causing behavior reminiscent of schizophrenia. Glutamate in action is extremely difficult to study due to its transient nature.\"|comment:\"drug absorption (MI:2045): Absorbed from the lumen of the small intestine into the enterocytes.Absorption is efficient and occurs by an active transport mechanism.\"|toxicity attribute name:Glutamate causes neuronal damage and eventual cell death, particularly when NMDA receptors are activated, High dosages of glutamic acid may include symptoms such as headaches and neurological problems.|drug metabolism:Hepatic|dosage form:Capsule Oral|organisms affected:Humans and other mammals|inchi id:\"InChI=1/C5H9NO4/c6-3(5(9)10)1-2-4(7)8/h3H,1-2,6H2,(H,7,8)(H,9,10)/t3-/m0/s1/f/h7,9H\"|comment:\"melting point (MI:2026): 224 oC\"|comment:\"isoelectric point (MI:2030): 2.23\"|comment:\"average molecular weight (MI:2155): 147.1293\"|comment:\"monoisotopic molecular weight (MI:2156): 147.0532\"|comment:\"experimental h2o solubility (MI:2157): 8.57 mg/mL at 25 oC [BULL,HB et al. (1978)]\"|comment:\"predicted h2o solubility (MI:2158): 8.06e+01 mg/mL [ALOGPS]\"|biotech prep:A sulfur containing essential amino acid that is important in many body functions. It is a chelating agent for heavy metals. [PubChem]|drug type:Small Molecule; Nutraceutical; Approved|drug category:Dietary supplement; Micronutrient; Essential Amino Acids|disease indication:Used for protein synthesis including the formation of SAMe, L-homocysteine, L-cysteine, taurine, and sulfate.|pharmacology:L-Methionine is a principle supplier of sulfur which prevents disorders of the hair, skin and nails; helps lower cholesterol levels by increasing the liver's production of lecithin; reduces liver fat and protects the kidneys; a natural chelating agent for heavy metals; regulates the formation of ammonia and creates ammonia-free urine which reduces bladder irritation; influences hair follicles and promotes hair growth. L-methionine may protect against the toxic effects of hepatotoxins, such as acetaminophen. Methionine may have antioxidant activity.|mechanism of action:The mechanism of the possible anti-hepatotoxic activity of L-methionine is not entirely clear. It is thought that metabolism of high doses of acetaminophen in the liver lead to decreased levels of hepatic glutathione and increased oxidative stress. L-methionine is a precursor to L-cysteine. L-cysteine itself may have antioxidant activity. L-cysteine is also a precursor to the antioxidant glutathione. Antioxidant activity of L-methionine and metabolites of L-methionine appear to account for its possible anti-hepatotoxic activity. Recent research suggests that methionine itself has free-radical scavenging activity by virtue of its sulfur, as well as its chelating ability.|comment:\"drug absorption (MI:2045): Absorbed from the lumen of the small intestine into the enterocytes by an active transport process.\"|toxicity attribute name:Doses of L-methionine of up to 250 mg daily are generally well tolerated. Higher doses may cause nausea, vomiting and headache. Healthy adults taking 8 grams of L-methionine daily for four days were found to have reduced serum folate levels and leucocytosis. Healthy adults taking 13.9 grams of L-methionine daily for five days were found to have changes in serum pH and potassium and increased urinary calcium excretion. Schizophrenic patients given 10 to 20 grams of L-methionine daily for two weeks developed functional psychoses. Single doses of 8 grams precipitated encephalopathy in patients with cirrhosis.|drug metabolism:Hepatic|dosage form:Capsule Oral|dosage form:Tablet Oral|dosage form:Powder Oral|organisms affected:Humans and other mammals|food interaction:Take with food.|inchi id:\"InChI=1/C5H11NO2S/c1-9-3-2-4(6)5(7)8/h4H,2-3,6H2,1H3,(H,7,8)/t4-/m0/s1/f/h7H\"|comment:\"melting point (MI:2026): 276-279 oC\"|comment:\"average molecular weight (MI:2155): 149.2113\"|comment:\"monoisotopic molecular weight (MI:2156): 149.0510\"|comment:\"experimental h2o solubility (MI:2157): 56.6 mg/mL at 25 oC [YALKOWSKY,SH & DANNENFELSER,RM (1992)]\"|comment:\"predicted h2o solubility (MI:2158): 2.39e+01 mg/mL [ALOGPS]\"|comment:\"experimental logs (MI:2161): -0.42 [ADME Research, USCD]\"|biotech prep:A non-essential amino acid present abundantly throughout the body and is involved in many metabolic processes. It is synthesized from glutamic acid and ammonia. It is the principal carrier of nitrogen in the body and is an important energy source for many cells. [PubChem]|drug type:Small Molecule; Nutraceutical; Approved|drug category:Dietary supplement; Micronutrient; Non-Essential Amino Acids|disease indication:Used for nutritional supplementation, also for treating dietary shortage or imbalance.|pharmacology:\"Like other amino acids, glutamine is biochemically important as a constituent of proteins. Glutamine is also crucial in nitrogen metabolism. Ammonia (formed by nitrogen fixation) is assimilated into organic compounds by converting glutamic acid to glutamine. The enzyme which accomplishes this is called glutamine synthetase. Glutamine can then be used as a nitrogen donor in the biosynthesis of many compounds, including other amino acids, purines, and pyrimidines.\"|mechanism of action:\"Supplemental L-glutamine's possible immunomodulatory role may be accounted for in a number of ways. L-glutamine appears to play a major role in protecting the integrity of the gastrointestinal tract and, in particular, the large intestine. During catabolic states, the integrity of the intestinal mucosa may be compromised with consequent increased intestinal permeability and translocation of Gram-negative bacteria from the large intestine into the body. The demand for L-glutamine by the intestine, as well as by cells such as lymphocytes, appears to be much greater than that supplied by skeletal muscle, the major storage tissue for L-glutamine. L-glutamine is the preferred respiratory fuel for enterocytes, colonocytes and lymphocytes. Therefore, supplying supplemental L-glutamine under these conditions may do a number of things. For one, it may reverse the catabolic state by sparing skeletal muscle L-glutamine. It also may inhibit translocation of Gram-negative bacteria from the large intestine. L-glutamine helps maintain secretory IgA, which functions primarily by preventing the attachment of bacteria to mucosal cells. L-glutamine appears to be required to support the proliferation of mitogen-stimulated lymphocytes, as well as the production of interleukin-2 (IL-2) and interferon-gamma (IFN-gamma). It is also required for the maintenance of lymphokine-activated killer cells (LAK). L-glutamine can enhance phagocytosis by neutrophils and monocytes. It can lead to an increased synthesis of glutathione in the intestine, which may also play a role in maintaining the integrity of the intestinal mucosa by ameliorating oxidative stress. The exact mechanism of the possible immunomodulatory action of supplemental L-glutamine, however, remains unclear. It is conceivable that the major effect of L-glutamine occurs at the level of the intestine. Perhaps enteral L-glutamine acts directly on intestine-associated lymphoid tissue and stimulates overall immune function by that mechanism, without passing beyond the splanchnic bed.\"|comment:\"drug absorption (MI:2045): Absorption is efficient and occurs by an active transport mechanism\"|toxicity attribute name:Doses of L-glutamine up to 21 grams daily appear to be well tolerated. Reported adverse reactions are mainly gastrointestinal and not common. They include constipation and bloating. There is one older report of two hypomanic patients whose manic symptoms were exacerbated following the use of 2 to 4 grams daily of L-glutamine. The symptoms resolved when the L-glutamine was stopped. These patients were not rechallenged, nor are there any other reports of this nature.|drug metabolism:Enterocytes, Hepatic|organisms affected:Humans and other mammals|inchi id:\"InChI=1/C5H10N2O3/c6-3(5(9)10)1-2-4(7)8/h3H,1-2,6H2,(H2,7,8)(H,9,10)/t3-/m0/s1/f/h9H,7H2\"|comment:\"melting point (MI:2026): 185 oC\"|comment:\"average molecular weight (MI:2155): 146.1445\"|comment:\"monoisotopic molecular weight (MI:2156): 146.0691\"|comment:\"experimental h2o solubility (MI:2157): Slight (0.1-1%)\"|comment:\"predicted h2o solubility (MI:2158): 9.78e+01 mg/mL [ALOGPS]\"|comment:\"experimental logs (MI:2161): -0.55 [ADME Research, USCD]\"\t-\t-\t-";

        final IntactDocumentDefinition documentDefinition = new IntactDocumentDefinition();
        final RowBuilder rowBuilder = documentDefinition.createRowBuilder();
        final Row row1 = rowBuilder.createRow( psiMiTabLine );

        RelevanceScoreCalculator rsc = new RelevanceScoreCalculatorImpl();
        String rscScore = rsc.calculateScore(row1);
        Properties properties = rsc.getWeights();

        Assert.assertEquals(4, properties.size());
        Assert.assertEquals("SM4-RL3",rscScore);

        //DrugPort mitabline
        //small molecule- protein interaction  expRoleA=drug expRoleB=drug target bioRoleA=unspecified role bioRoleB=unspecified role
        final String imatinibLine = "pubchem:5291|drugbank:DB00619|intact:DGI-337878\tuniprotkb:P08183|intact:DGI-296810\tintact:Imatinib Mesylate(drug brand name)|intact:Imatinib Methansulfonate(drug brand name)|intact:Imatinib(commercial name)|intact:Gleevec(drug brand name)|intact:Glivec(drug brand name)\tuniprotkb:MDR1(gene name synonym)|uniprotkb:PGY1(gene name synonym)|uniprotkb:ATP-binding cassette sub-family B member 1(gene name synonym)|uniprotkb:P-glycoprotein 1(gene name synonym)|uniprotkb:mdr1_human\t-\tuniprotkb:ABCB1\tpsi-mi:\"MI:0045\"(experimental interac)\t-\tpubmed:18048412\ttaxid:-3(unknown)\ttaxid:9606(human)\tpsi-mi:\"MI:0407\"(direct interaction)\tpsi-mi:\"MI:1002\"(DrugBank)\tintact:DGI-337971\t-\tpsi-mi:\"MI:1094\"(drug)\tpsi-mi:\"MI:1095\"(drug target)\tpsi-mi:\"MI:0499\"(unspecified role)\tpsi-mi:\"MI:0499\"(unspecified role)\tdrugbank:APRD01028|pubmed:12869662|pubmed:11175855|pubmed:16779792|pubmed:14988091|pubmed:15980865|din:02253283|pubchem:5291|drugbank:DB00619|intact:DGI-337878\tuniprotkb:P08183|intact:DGI-296810|ensembl:ENSG00000085563|refseq:NP_000918.2|go:\"GO:0009986\"(cell surface)|go:\"GO:0016021\"(integral to membrane)|go:\"GO:0005624\"(membrane fraction)|go:\"GO:0005524\"(ATP binding)|go:\"GO:0042626\"(ATPase activity, coupled to transmembrane movement of substances)|go:\"GO:0005515\"(protein binding)|go:\"GO:0042493\"(response to drug)|go:\"GO:0006810\"(transport)|interpro:IPR003593(AAA+ ATPase, core)|interpro:IPR011527(ABC transporter, transmembrane region, type 1)|interpro:IPR001140(ABC transporter, transmembrane region)|interpro:IPR003439(ABC transporter-like)|uniprotkb:Q12755|uniprotkb:Q14812\tpsi-mi:\"MI:0328\"(small molecule)\tpsi-mi:\"MI:0326\"(protein)\ttaxid:-3(unknown)\t-\tDrugBank - a knowledgebase for drugs, drug actions and drug targets.\tbiotech prep:\"Imatinib is a drug used to treat certain types of cancer. It is currently marketed by Novartis as Gleevec (USA) or Glivec (Europe/Australia) as its mesylate salt, imatinib mesilate (INN). It is occasionally referred to as CGP57148B or STI571 (especially in older publications). It is used in treating chronic myelogenous leukemia (CML), gastrointestinal stromal tumors (GISTs) and a number of other malignancies.It is the first member of a new class of agents that act by inhibiting particular tyrosine kinase enzymes, instead of non-specifically inhibiting rapidly dividing cells.\"|drug type:Small Molecule; Approved|drug category:Antineoplastic Agents; Protein Kinase Inhibitors|disease indication:\"For the treatment of newly diagnosed adult patients with Philadelphia chromosome positive chronic myeloid leukemia (CML). Also indicated for the treatment of pediatric patients with Ph+ chronic phase CML whose disease has recurred after stem cell transplant or who are resistant to interferon-alpha therapy. Also indicated with unresectable and/or metastatic malignant gastrointestinal stromal tumors (GIST).\"|pharmacology:\"Imatinib is an antineoplastic agent used to treat chronic myelogenous leukemia. Imatinib is a 2-phenylaminopyrimidine derivative that functions as a specific inhibitor of a number of tyrosine kinase enzymes. In chronic myelogenous leukemia, the Philadelphia chromosome leads to a fusion protein of Abl with Bcr (breakpoint cluster region), termed Bcr-Abl. As this is now a continuously active tyrosine kinase, Imatinib is used to decrease Bcr-Abl activity.\"|mechanism of action:\"Imatinib mesylate is a protein-tyrosine kinase inhibitor that inhibits the Bcr-Abl tyrosine kinase, the constitutive abnormal tyrosine kinase created by the Philadelphia chromosome abnormality in chronic myeloid leukemia (CML). It inhibits proliferation and induces apoptosis in Bcr-Abl positive cell lines as well as fresh leukemic cells from Philadelphia chromosome positive chronic myeloid leukemia. Imatinib also inhibits the receptor tyrosine kinases for platelet derived growth factor (PDGF) and stem cell factor (SCF) - called c-kit. Imatinib was identified in the late 1990s by Dr Brian J. Druker. Its development is an excellent example of rational drug design. Soon after identification of the bcr-abl target, the search for an inhibitor began. Chemists used a high-throughput screen of chemical libraries to identify the molecule 2-phenylaminopyrimidine. This lead compound was then tested and modified by the introduction of methyl and benzamide groups to give it enhanced binding properties, resulting in imatinib.\"|comment:\"drug absorption (MI:2045): Imatinib is well absorbed with mean absolute bioavailability is 98% with maximum levels achieved within 2-4 hours of dosing\"|toxicity attribute name:\"Side effects include nausea, vomiting, diarrhea, loss of appetite, dry skin, hair loss, swelling (especially in the legs or around the eyes) and muscle cramps\"|comment:\"plasma protein binding (MI:2047):Very high (95%)\"|drug metabolism:Primarily hepatic via CYP3A4. Other cytochrome P450 enzymes, such as CYP1A2, CYP2D6, CYP2C9, and CYP2C19, play a minor role in its metabolism. The main circulating active metabolite in humans is the N-demethylated piperazine derivative, formed predominantly by CYP3A4.|comment:\"elimination half life (MI:2049): 18 hours for Imatinib, 40 hours for its major active metabolite, the N-desmethyl derivative\"|dosage form:Tablet Oral|dosage form:Capsule Oral|organisms affected:Humans and other mammals|food interaction:Take with food to reduce the incidence of gastric irritation. Follow with a large glass of water. A lipid rich meal will slightly reduce and delay absorption. Avoid grapefruit and grapefruit juice throughout treatment, grapefruit can significantly increase serum levels of this product.|drug interaction:Acetaminophen Increased hepatic toxicity of both agents|drug interaction:Anisindione Imatinib increases the anticoagulant effect|drug interaction:Dicumarol Imatinib increases the anticoagulant effect|drug interaction:Acenocoumarol Imatinib increases the anticoagulant effect|drug interaction:Warfarin Imatinib increases the anticoagulant effect|drug interaction:Aprepitant Aprepitant may change levels of chemotherapy agent|drug interaction:Atorvastatin Increases the effect and toxicity of atorvastatin|drug interaction:Carbamazepine Carbamazepine decreases levels of imatinib|drug interaction:Cerivastatin Imatinib increases the effect and toxicity of statin|drug interaction:Cyclosporine Imatinib increases the effect and toxicity of cyclosporine|drug interaction:Dexamethasone Dexamethasone decreases levels of imatinib|drug interaction:Lovastatin Imatinib increases the effect and toxicity of statin|drug interaction:Simvastatin Imatinib increases the effect and toxicity of statin|drug interaction:St. John's Wort St. John's Wort decreases levels of imatinib|drug interaction:Rifampin Rifampin decreases levels of imatinib|drug interaction:Pimozide Increases the effect and toxicity of pimozide|drug interaction:Phenobarbital Phenobarbital decreases levels of imatinib|drug interaction:Nifedipine Imatinib increases the effect and toxicity of nifedipine|drug interaction:Clarithromycin The macrolide increases levels of imatinib|drug interaction:Erythromycin The macrolide increases levels of imatinib|drug interaction:Josamycin The macrolide increases levels of imatinib|drug interaction:Ketoconazole The imidazole increases the levels of imatinib|drug interaction:Itraconazole The imidazole increases the levels of imatinib|drug interaction:Ethotoin The hydantoin decreases the levels of imatinib|drug interaction:Fosphenytoin The hydantoin decreases the levels of imatinib|drug interaction:Mephenytoin The hydantoin decreases the levels of imatinib|drug interaction:Phenytoin The hydantoin decreases the levels of imatinib|inchi id:\"InChI=1/C29H31N7O/c1-21-5-10-25(18-27(21)34-29-31-13-11-26(33-29)24-4-3-12-30-19-24)32-28(37)23-8-6-22(7-9-23)20-36-16-14-35(2)15-17-36/h3-13,18-19H,14-17,20H2,1-2H3,(H,32,37)(H,31,33,34)/f/h32,34H\"|url:\"http://www.rxlist.com/cgi/generic3/gleevec.htm\"|comment:\"melting point (MI:2026): 226 oC (mesylate salt)\"|comment:\"average molecular weight (MI:2155): 493.6027\"|comment:\"monoisotopic molecular weight (MI:2156): 493.2590\"|comment:\"experimental h2o solubility (MI:2157): Very soluble in water at pH < 5.5 (mesylate salt)\"|comment:\"predicted h2o solubility (MI:2158): 1.46e-02 mg/mL [ALOGPS]\"\t-\t-\t-\t-";
        Row row2 = rowBuilder.createRow( imatinibLine );

        rscScore = rsc.calculateScore(row2);
        properties = rsc.getWeights();

        Assert.assertEquals(8, properties.size());
        Assert.assertEquals("SM8-RL7",rscScore);


        //repeat imatinib line ...the count of properties should not change and u should get the same score
        final String imatinibLine2 = "pubchem:5291|drugbank:DB00619|intact:DGI-337878\tuniprotkb:P08183|intact:DGI-296810\tintact:Imatinib Mesylate(drug brand name)|intact:Imatinib Methansulfonate(drug brand name)|intact:Imatinib(commercial name)|intact:Gleevec(drug brand name)|intact:Glivec(drug brand name)\tuniprotkb:MDR1(gene name synonym)|uniprotkb:PGY1(gene name synonym)|uniprotkb:ATP-binding cassette sub-family B member 1(gene name synonym)|uniprotkb:P-glycoprotein 1(gene name synonym)|uniprotkb:mdr1_human\t-\tuniprotkb:ABCB1\tpsi-mi:\"MI:0045\"(experimental interac)\t-\tpubmed:18048412\ttaxid:-3(unknown)\ttaxid:9606(human)\tpsi-mi:\"MI:0407\"(direct interaction)\tpsi-mi:\"MI:1002\"(DrugBank)\tintact:DGI-337971\t-\tpsi-mi:\"MI:1094\"(drug)\tpsi-mi:\"MI:1095\"(drug target)\tpsi-mi:\"MI:0499\"(unspecified role)\tpsi-mi:\"MI:0499\"(unspecified role)\tdrugbank:APRD01028|pubmed:12869662|pubmed:11175855|pubmed:16779792|pubmed:14988091|pubmed:15980865|din:02253283|pubchem:5291|drugbank:DB00619|intact:DGI-337878\tuniprotkb:P08183|intact:DGI-296810|ensembl:ENSG00000085563|refseq:NP_000918.2|go:\"GO:0009986\"(cell surface)|go:\"GO:0016021\"(integral to membrane)|go:\"GO:0005624\"(membrane fraction)|go:\"GO:0005524\"(ATP binding)|go:\"GO:0042626\"(ATPase activity, coupled to transmembrane movement of substances)|go:\"GO:0005515\"(protein binding)|go:\"GO:0042493\"(response to drug)|go:\"GO:0006810\"(transport)|interpro:IPR003593(AAA+ ATPase, core)|interpro:IPR011527(ABC transporter, transmembrane region, type 1)|interpro:IPR001140(ABC transporter, transmembrane region)|interpro:IPR003439(ABC transporter-like)|uniprotkb:Q12755|uniprotkb:Q14812\tpsi-mi:\"MI:0328\"(small molecule)\tpsi-mi:\"MI:0326\"(protein)\ttaxid:-3(unknown)\t-\tDrugBank - a knowledgebase for drugs, drug actions and drug targets.\tbiotech prep:\"Imatinib is a drug used to treat certain types of cancer. It is currently marketed by Novartis as Gleevec (USA) or Glivec (Europe/Australia) as its mesylate salt, imatinib mesilate (INN). It is occasionally referred to as CGP57148B or STI571 (especially in older publications). It is used in treating chronic myelogenous leukemia (CML), gastrointestinal stromal tumors (GISTs) and a number of other malignancies.It is the first member of a new class of agents that act by inhibiting particular tyrosine kinase enzymes, instead of non-specifically inhibiting rapidly dividing cells.\"|drug type:Small Molecule; Approved|drug category:Antineoplastic Agents; Protein Kinase Inhibitors|disease indication:\"For the treatment of newly diagnosed adult patients with Philadelphia chromosome positive chronic myeloid leukemia (CML). Also indicated for the treatment of pediatric patients with Ph+ chronic phase CML whose disease has recurred after stem cell transplant or who are resistant to interferon-alpha therapy. Also indicated with unresectable and/or metastatic malignant gastrointestinal stromal tumors (GIST).\"|pharmacology:\"Imatinib is an antineoplastic agent used to treat chronic myelogenous leukemia. Imatinib is a 2-phenylaminopyrimidine derivative that functions as a specific inhibitor of a number of tyrosine kinase enzymes. In chronic myelogenous leukemia, the Philadelphia chromosome leads to a fusion protein of Abl with Bcr (breakpoint cluster region), termed Bcr-Abl. As this is now a continuously active tyrosine kinase, Imatinib is used to decrease Bcr-Abl activity.\"|mechanism of action:\"Imatinib mesylate is a protein-tyrosine kinase inhibitor that inhibits the Bcr-Abl tyrosine kinase, the constitutive abnormal tyrosine kinase created by the Philadelphia chromosome abnormality in chronic myeloid leukemia (CML). It inhibits proliferation and induces apoptosis in Bcr-Abl positive cell lines as well as fresh leukemic cells from Philadelphia chromosome positive chronic myeloid leukemia. Imatinib also inhibits the receptor tyrosine kinases for platelet derived growth factor (PDGF) and stem cell factor (SCF) - called c-kit. Imatinib was identified in the late 1990s by Dr Brian J. Druker. Its development is an excellent example of rational drug design. Soon after identification of the bcr-abl target, the search for an inhibitor began. Chemists used a high-throughput screen of chemical libraries to identify the molecule 2-phenylaminopyrimidine. This lead compound was then tested and modified by the introduction of methyl and benzamide groups to give it enhanced binding properties, resulting in imatinib.\"|comment:\"drug absorption (MI:2045): Imatinib is well absorbed with mean absolute bioavailability is 98% with maximum levels achieved within 2-4 hours of dosing\"|toxicity attribute name:\"Side effects include nausea, vomiting, diarrhea, loss of appetite, dry skin, hair loss, swelling (especially in the legs or around the eyes) and muscle cramps\"|comment:\"plasma protein binding (MI:2047):Very high (95%)\"|drug metabolism:Primarily hepatic via CYP3A4. Other cytochrome P450 enzymes, such as CYP1A2, CYP2D6, CYP2C9, and CYP2C19, play a minor role in its metabolism. The main circulating active metabolite in humans is the N-demethylated piperazine derivative, formed predominantly by CYP3A4.|comment:\"elimination half life (MI:2049): 18 hours for Imatinib, 40 hours for its major active metabolite, the N-desmethyl derivative\"|dosage form:Tablet Oral|dosage form:Capsule Oral|organisms affected:Humans and other mammals|food interaction:Take with food to reduce the incidence of gastric irritation. Follow with a large glass of water. A lipid rich meal will slightly reduce and delay absorption. Avoid grapefruit and grapefruit juice throughout treatment, grapefruit can significantly increase serum levels of this product.|drug interaction:Acetaminophen Increased hepatic toxicity of both agents|drug interaction:Anisindione Imatinib increases the anticoagulant effect|drug interaction:Dicumarol Imatinib increases the anticoagulant effect|drug interaction:Acenocoumarol Imatinib increases the anticoagulant effect|drug interaction:Warfarin Imatinib increases the anticoagulant effect|drug interaction:Aprepitant Aprepitant may change levels of chemotherapy agent|drug interaction:Atorvastatin Increases the effect and toxicity of atorvastatin|drug interaction:Carbamazepine Carbamazepine decreases levels of imatinib|drug interaction:Cerivastatin Imatinib increases the effect and toxicity of statin|drug interaction:Cyclosporine Imatinib increases the effect and toxicity of cyclosporine|drug interaction:Dexamethasone Dexamethasone decreases levels of imatinib|drug interaction:Lovastatin Imatinib increases the effect and toxicity of statin|drug interaction:Simvastatin Imatinib increases the effect and toxicity of statin|drug interaction:St. John's Wort St. John's Wort decreases levels of imatinib|drug interaction:Rifampin Rifampin decreases levels of imatinib|drug interaction:Pimozide Increases the effect and toxicity of pimozide|drug interaction:Phenobarbital Phenobarbital decreases levels of imatinib|drug interaction:Nifedipine Imatinib increases the effect and toxicity of nifedipine|drug interaction:Clarithromycin The macrolide increases levels of imatinib|drug interaction:Erythromycin The macrolide increases levels of imatinib|drug interaction:Josamycin The macrolide increases levels of imatinib|drug interaction:Ketoconazole The imidazole increases the levels of imatinib|drug interaction:Itraconazole The imidazole increases the levels of imatinib|drug interaction:Ethotoin The hydantoin decreases the levels of imatinib|drug interaction:Fosphenytoin The hydantoin decreases the levels of imatinib|drug interaction:Mephenytoin The hydantoin decreases the levels of imatinib|drug interaction:Phenytoin The hydantoin decreases the levels of imatinib|inchi id:\"InChI=1/C29H31N7O/c1-21-5-10-25(18-27(21)34-29-31-13-11-26(33-29)24-4-3-12-30-19-24)32-28(37)23-8-6-22(7-9-23)20-36-16-14-35(2)15-17-36/h3-13,18-19H,14-17,20H2,1-2H3,(H,32,37)(H,31,33,34)/f/h32,34H\"|url:\"http://www.rxlist.com/cgi/generic3/gleevec.htm\"|comment:\"melting point (MI:2026): 226 oC (mesylate salt)\"|comment:\"average molecular weight (MI:2155): 493.6027\"|comment:\"monoisotopic molecular weight (MI:2156): 493.2590\"|comment:\"experimental h2o solubility (MI:2157): Very soluble in water at pH < 5.5 (mesylate salt)\"|comment:\"predicted h2o solubility (MI:2158): 1.46e-02 mg/mL [ALOGPS]\"\t-\t-\t-\t-";
        Row row3 = rowBuilder.createRow( imatinibLine2 );

        rscScore = rsc.calculateScore(row3);
        properties = rsc.getWeights();

        Assert.assertEquals(8, properties.size());
        Assert.assertEquals("SM8-RL7",rscScore);

        printProperties( properties );

    }

    @Test
    public void getRscScoreTestWithInitializedProperties() throws Exception {

        Properties properties = new Properties();
        properties.put("protein-small molecule","A");
        properties.put("protein-protein","B");
        properties.put("drug-drug target","C");
        properties.put("bait-prey","D");

        //Protein-Protein interaction with expRoleA=prey expRoleB=bait bioRoleA=unspecified role bioRoleB=unspecified role
        String psiMiTabLine = "uniprotkb:P16884|intact:EBI-446344\tuniprotkb:Q60824|intact:EBI-446159\tuniprotkb:Nefh(gene name)\tuniprotkb:Dst(gene name)\tintact:Nfh\tintact:Bpag1\tMI:0018(2 hybrid)\tLeung et al. (1999)\tpubmed:9971739\ttaxid:10116(rat)\ttaxid:10090(mouse)\tMI:0218(physical interaction)\tMI:0469(intact)\tintact:EBI-446356\t-\tMI:0498(prey)\tMI:0496(bait)\tMI:0499(unspecified role)\tMI:0499(unspecified role)\tinterpro:IPR004829|interpro:IPR010790|interpro:IPR001664|uniprotkb:O35482|rgd:3159|ensembl:ENSRNOG00000008716|uniprotkb:Q540Z7|uniprotkb:Q63368\tgo:0005737|go:0030056|go:0005200|go:0045104|interpro:IPR001589|interpro:IPR001715|interpro:IPR002048|interpro:IPR001101|uniprotkb:Q60845|uniprotkb:Q9WU50|go:0008090|go:0015629|go:0015630|go:0060053|go:0008017|go:0031122|go:0031110|ensembl:ENSMUSG00000026131\tMI:0326(protein)\tMI:0326(protein)\tyeast:4932\t-\t-";

        final IntactDocumentDefinition documentDefinition = new IntactDocumentDefinition();
        final RowBuilder rowBuilder = documentDefinition.createRowBuilder();
        final Row row1 = rowBuilder.createRow( psiMiTabLine );

        RelevanceScoreCalculator rsc = new RelevanceScoreCalculatorImpl(properties);
        String rscScore = rsc.calculateScore(row1);
        properties = rsc.getWeights();

        Assert.assertEquals(6, properties.size());
        Assert.assertEquals("B-D",rscScore);

        //DrugPort mitabline
        //small molecule- protein interaction  expRoleA=drug expRoleB=drug target bioRoleA=unspecified role bioRoleB=unspecified role
        final String imatinibLine = "pubchem:5291|drugbank:DB00619|intact:DGI-337878\tuniprotkb:P08183|intact:DGI-296810\tintact:Imatinib Mesylate(drug brand name)|intact:Imatinib Methansulfonate(drug brand name)|intact:Imatinib(commercial name)|intact:Gleevec(drug brand name)|intact:Glivec(drug brand name)\tuniprotkb:MDR1(gene name synonym)|uniprotkb:PGY1(gene name synonym)|uniprotkb:ATP-binding cassette sub-family B member 1(gene name synonym)|uniprotkb:P-glycoprotein 1(gene name synonym)|uniprotkb:mdr1_human\t-\tuniprotkb:ABCB1\tpsi-mi:\"MI:0045\"(experimental interac)\t-\tpubmed:18048412\ttaxid:-3(unknown)\ttaxid:9606(human)\tpsi-mi:\"MI:0407\"(direct interaction)\tpsi-mi:\"MI:1002\"(DrugBank)\tintact:DGI-337971\t-\tpsi-mi:\"MI:1094\"(drug)\tpsi-mi:\"MI:1095\"(drug target)\tpsi-mi:\"MI:0499\"(unspecified role)\tpsi-mi:\"MI:0499\"(unspecified role)\tdrugbank:APRD01028|pubmed:12869662|pubmed:11175855|pubmed:16779792|pubmed:14988091|pubmed:15980865|din:02253283|pubchem:5291|drugbank:DB00619|intact:DGI-337878\tuniprotkb:P08183|intact:DGI-296810|ensembl:ENSG00000085563|refseq:NP_000918.2|go:\"GO:0009986\"(cell surface)|go:\"GO:0016021\"(integral to membrane)|go:\"GO:0005624\"(membrane fraction)|go:\"GO:0005524\"(ATP binding)|go:\"GO:0042626\"(ATPase activity, coupled to transmembrane movement of substances)|go:\"GO:0005515\"(protein binding)|go:\"GO:0042493\"(response to drug)|go:\"GO:0006810\"(transport)|interpro:IPR003593(AAA+ ATPase, core)|interpro:IPR011527(ABC transporter, transmembrane region, type 1)|interpro:IPR001140(ABC transporter, transmembrane region)|interpro:IPR003439(ABC transporter-like)|uniprotkb:Q12755|uniprotkb:Q14812\tpsi-mi:\"MI:0328\"(small molecule)\tpsi-mi:\"MI:0326\"(protein)\ttaxid:-3(unknown)\t-\tDrugBank - a knowledgebase for drugs, drug actions and drug targets.\tbiotech prep:\"Imatinib is a drug used to treat certain types of cancer. It is currently marketed by Novartis as Gleevec (USA) or Glivec (Europe/Australia) as its mesylate salt, imatinib mesilate (INN). It is occasionally referred to as CGP57148B or STI571 (especially in older publications). It is used in treating chronic myelogenous leukemia (CML), gastrointestinal stromal tumors (GISTs) and a number of other malignancies.It is the first member of a new class of agents that act by inhibiting particular tyrosine kinase enzymes, instead of non-specifically inhibiting rapidly dividing cells.\"|drug type:Small Molecule; Approved|drug category:Antineoplastic Agents; Protein Kinase Inhibitors|disease indication:\"For the treatment of newly diagnosed adult patients with Philadelphia chromosome positive chronic myeloid leukemia (CML). Also indicated for the treatment of pediatric patients with Ph+ chronic phase CML whose disease has recurred after stem cell transplant or who are resistant to interferon-alpha therapy. Also indicated with unresectable and/or metastatic malignant gastrointestinal stromal tumors (GIST).\"|pharmacology:\"Imatinib is an antineoplastic agent used to treat chronic myelogenous leukemia. Imatinib is a 2-phenylaminopyrimidine derivative that functions as a specific inhibitor of a number of tyrosine kinase enzymes. In chronic myelogenous leukemia, the Philadelphia chromosome leads to a fusion protein of Abl with Bcr (breakpoint cluster region), termed Bcr-Abl. As this is now a continuously active tyrosine kinase, Imatinib is used to decrease Bcr-Abl activity.\"|mechanism of action:\"Imatinib mesylate is a protein-tyrosine kinase inhibitor that inhibits the Bcr-Abl tyrosine kinase, the constitutive abnormal tyrosine kinase created by the Philadelphia chromosome abnormality in chronic myeloid leukemia (CML). It inhibits proliferation and induces apoptosis in Bcr-Abl positive cell lines as well as fresh leukemic cells from Philadelphia chromosome positive chronic myeloid leukemia. Imatinib also inhibits the receptor tyrosine kinases for platelet derived growth factor (PDGF) and stem cell factor (SCF) - called c-kit. Imatinib was identified in the late 1990s by Dr Brian J. Druker. Its development is an excellent example of rational drug design. Soon after identification of the bcr-abl target, the search for an inhibitor began. Chemists used a high-throughput screen of chemical libraries to identify the molecule 2-phenylaminopyrimidine. This lead compound was then tested and modified by the introduction of methyl and benzamide groups to give it enhanced binding properties, resulting in imatinib.\"|comment:\"drug absorption (MI:2045): Imatinib is well absorbed with mean absolute bioavailability is 98% with maximum levels achieved within 2-4 hours of dosing\"|toxicity attribute name:\"Side effects include nausea, vomiting, diarrhea, loss of appetite, dry skin, hair loss, swelling (especially in the legs or around the eyes) and muscle cramps\"|comment:\"plasma protein binding (MI:2047):Very high (95%)\"|drug metabolism:Primarily hepatic via CYP3A4. Other cytochrome P450 enzymes, such as CYP1A2, CYP2D6, CYP2C9, and CYP2C19, play a minor role in its metabolism. The main circulating active metabolite in humans is the N-demethylated piperazine derivative, formed predominantly by CYP3A4.|comment:\"elimination half life (MI:2049): 18 hours for Imatinib, 40 hours for its major active metabolite, the N-desmethyl derivative\"|dosage form:Tablet Oral|dosage form:Capsule Oral|organisms affected:Humans and other mammals|food interaction:Take with food to reduce the incidence of gastric irritation. Follow with a large glass of water. A lipid rich meal will slightly reduce and delay absorption. Avoid grapefruit and grapefruit juice throughout treatment, grapefruit can significantly increase serum levels of this product.|drug interaction:Acetaminophen Increased hepatic toxicity of both agents|drug interaction:Anisindione Imatinib increases the anticoagulant effect|drug interaction:Dicumarol Imatinib increases the anticoagulant effect|drug interaction:Acenocoumarol Imatinib increases the anticoagulant effect|drug interaction:Warfarin Imatinib increases the anticoagulant effect|drug interaction:Aprepitant Aprepitant may change levels of chemotherapy agent|drug interaction:Atorvastatin Increases the effect and toxicity of atorvastatin|drug interaction:Carbamazepine Carbamazepine decreases levels of imatinib|drug interaction:Cerivastatin Imatinib increases the effect and toxicity of statin|drug interaction:Cyclosporine Imatinib increases the effect and toxicity of cyclosporine|drug interaction:Dexamethasone Dexamethasone decreases levels of imatinib|drug interaction:Lovastatin Imatinib increases the effect and toxicity of statin|drug interaction:Simvastatin Imatinib increases the effect and toxicity of statin|drug interaction:St. John's Wort St. John's Wort decreases levels of imatinib|drug interaction:Rifampin Rifampin decreases levels of imatinib|drug interaction:Pimozide Increases the effect and toxicity of pimozide|drug interaction:Phenobarbital Phenobarbital decreases levels of imatinib|drug interaction:Nifedipine Imatinib increases the effect and toxicity of nifedipine|drug interaction:Clarithromycin The macrolide increases levels of imatinib|drug interaction:Erythromycin The macrolide increases levels of imatinib|drug interaction:Josamycin The macrolide increases levels of imatinib|drug interaction:Ketoconazole The imidazole increases the levels of imatinib|drug interaction:Itraconazole The imidazole increases the levels of imatinib|drug interaction:Ethotoin The hydantoin decreases the levels of imatinib|drug interaction:Fosphenytoin The hydantoin decreases the levels of imatinib|drug interaction:Mephenytoin The hydantoin decreases the levels of imatinib|drug interaction:Phenytoin The hydantoin decreases the levels of imatinib|inchi id:\"InChI=1/C29H31N7O/c1-21-5-10-25(18-27(21)34-29-31-13-11-26(33-29)24-4-3-12-30-19-24)32-28(37)23-8-6-22(7-9-23)20-36-16-14-35(2)15-17-36/h3-13,18-19H,14-17,20H2,1-2H3,(H,32,37)(H,31,33,34)/f/h32,34H\"|url:\"http://www.rxlist.com/cgi/generic3/gleevec.htm\"|comment:\"melting point (MI:2026): 226 oC (mesylate salt)\"|comment:\"average molecular weight (MI:2155): 493.6027\"|comment:\"monoisotopic molecular weight (MI:2156): 493.2590\"|comment:\"experimental h2o solubility (MI:2157): Very soluble in water at pH < 5.5 (mesylate salt)\"|comment:\"predicted h2o solubility (MI:2158): 1.46e-02 mg/mL [ALOGPS]\"\t-\t-\t-\t-";
        Row row2 = rowBuilder.createRow( imatinibLine );

        rscScore = rsc.calculateScore(row2);
        properties = rsc.getWeights();

        Assert.assertEquals(8, properties.size());
        Assert.assertEquals("A-C",rscScore);


        //repeat imatinib line ...the count of properties should not change and u should get the same score
        final String imatinibLine2 = "pubchem:5291|drugbank:DB00619|intact:DGI-337878\tuniprotkb:P08183|intact:DGI-296810\tintact:Imatinib Mesylate(drug brand name)|intact:Imatinib Methansulfonate(drug brand name)|intact:Imatinib(commercial name)|intact:Gleevec(drug brand name)|intact:Glivec(drug brand name)\tuniprotkb:MDR1(gene name synonym)|uniprotkb:PGY1(gene name synonym)|uniprotkb:ATP-binding cassette sub-family B member 1(gene name synonym)|uniprotkb:P-glycoprotein 1(gene name synonym)|uniprotkb:mdr1_human\t-\tuniprotkb:ABCB1\tpsi-mi:\"MI:0045\"(experimental interac)\t-\tpubmed:18048412\ttaxid:-3(unknown)\ttaxid:9606(human)\tpsi-mi:\"MI:0407\"(direct interaction)\tpsi-mi:\"MI:1002\"(DrugBank)\tintact:DGI-337971\t-\tpsi-mi:\"MI:1094\"(drug)\tpsi-mi:\"MI:1095\"(drug target)\tpsi-mi:\"MI:0499\"(unspecified role)\tpsi-mi:\"MI:0499\"(unspecified role)\tdrugbank:APRD01028|pubmed:12869662|pubmed:11175855|pubmed:16779792|pubmed:14988091|pubmed:15980865|din:02253283|pubchem:5291|drugbank:DB00619|intact:DGI-337878\tuniprotkb:P08183|intact:DGI-296810|ensembl:ENSG00000085563|refseq:NP_000918.2|go:\"GO:0009986\"(cell surface)|go:\"GO:0016021\"(integral to membrane)|go:\"GO:0005624\"(membrane fraction)|go:\"GO:0005524\"(ATP binding)|go:\"GO:0042626\"(ATPase activity, coupled to transmembrane movement of substances)|go:\"GO:0005515\"(protein binding)|go:\"GO:0042493\"(response to drug)|go:\"GO:0006810\"(transport)|interpro:IPR003593(AAA+ ATPase, core)|interpro:IPR011527(ABC transporter, transmembrane region, type 1)|interpro:IPR001140(ABC transporter, transmembrane region)|interpro:IPR003439(ABC transporter-like)|uniprotkb:Q12755|uniprotkb:Q14812\tpsi-mi:\"MI:0328\"(small molecule)\tpsi-mi:\"MI:0326\"(protein)\ttaxid:-3(unknown)\t-\tDrugBank - a knowledgebase for drugs, drug actions and drug targets.\tbiotech prep:\"Imatinib is a drug used to treat certain types of cancer. It is currently marketed by Novartis as Gleevec (USA) or Glivec (Europe/Australia) as its mesylate salt, imatinib mesilate (INN). It is occasionally referred to as CGP57148B or STI571 (especially in older publications). It is used in treating chronic myelogenous leukemia (CML), gastrointestinal stromal tumors (GISTs) and a number of other malignancies.It is the first member of a new class of agents that act by inhibiting particular tyrosine kinase enzymes, instead of non-specifically inhibiting rapidly dividing cells.\"|drug type:Small Molecule; Approved|drug category:Antineoplastic Agents; Protein Kinase Inhibitors|disease indication:\"For the treatment of newly diagnosed adult patients with Philadelphia chromosome positive chronic myeloid leukemia (CML). Also indicated for the treatment of pediatric patients with Ph+ chronic phase CML whose disease has recurred after stem cell transplant or who are resistant to interferon-alpha therapy. Also indicated with unresectable and/or metastatic malignant gastrointestinal stromal tumors (GIST).\"|pharmacology:\"Imatinib is an antineoplastic agent used to treat chronic myelogenous leukemia. Imatinib is a 2-phenylaminopyrimidine derivative that functions as a specific inhibitor of a number of tyrosine kinase enzymes. In chronic myelogenous leukemia, the Philadelphia chromosome leads to a fusion protein of Abl with Bcr (breakpoint cluster region), termed Bcr-Abl. As this is now a continuously active tyrosine kinase, Imatinib is used to decrease Bcr-Abl activity.\"|mechanism of action:\"Imatinib mesylate is a protein-tyrosine kinase inhibitor that inhibits the Bcr-Abl tyrosine kinase, the constitutive abnormal tyrosine kinase created by the Philadelphia chromosome abnormality in chronic myeloid leukemia (CML). It inhibits proliferation and induces apoptosis in Bcr-Abl positive cell lines as well as fresh leukemic cells from Philadelphia chromosome positive chronic myeloid leukemia. Imatinib also inhibits the receptor tyrosine kinases for platelet derived growth factor (PDGF) and stem cell factor (SCF) - called c-kit. Imatinib was identified in the late 1990s by Dr Brian J. Druker. Its development is an excellent example of rational drug design. Soon after identification of the bcr-abl target, the search for an inhibitor began. Chemists used a high-throughput screen of chemical libraries to identify the molecule 2-phenylaminopyrimidine. This lead compound was then tested and modified by the introduction of methyl and benzamide groups to give it enhanced binding properties, resulting in imatinib.\"|comment:\"drug absorption (MI:2045): Imatinib is well absorbed with mean absolute bioavailability is 98% with maximum levels achieved within 2-4 hours of dosing\"|toxicity attribute name:\"Side effects include nausea, vomiting, diarrhea, loss of appetite, dry skin, hair loss, swelling (especially in the legs or around the eyes) and muscle cramps\"|comment:\"plasma protein binding (MI:2047):Very high (95%)\"|drug metabolism:Primarily hepatic via CYP3A4. Other cytochrome P450 enzymes, such as CYP1A2, CYP2D6, CYP2C9, and CYP2C19, play a minor role in its metabolism. The main circulating active metabolite in humans is the N-demethylated piperazine derivative, formed predominantly by CYP3A4.|comment:\"elimination half life (MI:2049): 18 hours for Imatinib, 40 hours for its major active metabolite, the N-desmethyl derivative\"|dosage form:Tablet Oral|dosage form:Capsule Oral|organisms affected:Humans and other mammals|food interaction:Take with food to reduce the incidence of gastric irritation. Follow with a large glass of water. A lipid rich meal will slightly reduce and delay absorption. Avoid grapefruit and grapefruit juice throughout treatment, grapefruit can significantly increase serum levels of this product.|drug interaction:Acetaminophen Increased hepatic toxicity of both agents|drug interaction:Anisindione Imatinib increases the anticoagulant effect|drug interaction:Dicumarol Imatinib increases the anticoagulant effect|drug interaction:Acenocoumarol Imatinib increases the anticoagulant effect|drug interaction:Warfarin Imatinib increases the anticoagulant effect|drug interaction:Aprepitant Aprepitant may change levels of chemotherapy agent|drug interaction:Atorvastatin Increases the effect and toxicity of atorvastatin|drug interaction:Carbamazepine Carbamazepine decreases levels of imatinib|drug interaction:Cerivastatin Imatinib increases the effect and toxicity of statin|drug interaction:Cyclosporine Imatinib increases the effect and toxicity of cyclosporine|drug interaction:Dexamethasone Dexamethasone decreases levels of imatinib|drug interaction:Lovastatin Imatinib increases the effect and toxicity of statin|drug interaction:Simvastatin Imatinib increases the effect and toxicity of statin|drug interaction:St. John's Wort St. John's Wort decreases levels of imatinib|drug interaction:Rifampin Rifampin decreases levels of imatinib|drug interaction:Pimozide Increases the effect and toxicity of pimozide|drug interaction:Phenobarbital Phenobarbital decreases levels of imatinib|drug interaction:Nifedipine Imatinib increases the effect and toxicity of nifedipine|drug interaction:Clarithromycin The macrolide increases levels of imatinib|drug interaction:Erythromycin The macrolide increases levels of imatinib|drug interaction:Josamycin The macrolide increases levels of imatinib|drug interaction:Ketoconazole The imidazole increases the levels of imatinib|drug interaction:Itraconazole The imidazole increases the levels of imatinib|drug interaction:Ethotoin The hydantoin decreases the levels of imatinib|drug interaction:Fosphenytoin The hydantoin decreases the levels of imatinib|drug interaction:Mephenytoin The hydantoin decreases the levels of imatinib|drug interaction:Phenytoin The hydantoin decreases the levels of imatinib|inchi id:\"InChI=1/C29H31N7O/c1-21-5-10-25(18-27(21)34-29-31-13-11-26(33-29)24-4-3-12-30-19-24)32-28(37)23-8-6-22(7-9-23)20-36-16-14-35(2)15-17-36/h3-13,18-19H,14-17,20H2,1-2H3,(H,32,37)(H,31,33,34)/f/h32,34H\"|url:\"http://www.rxlist.com/cgi/generic3/gleevec.htm\"|comment:\"melting point (MI:2026): 226 oC (mesylate salt)\"|comment:\"average molecular weight (MI:2155): 493.6027\"|comment:\"monoisotopic molecular weight (MI:2156): 493.2590\"|comment:\"experimental h2o solubility (MI:2157): Very soluble in water at pH < 5.5 (mesylate salt)\"|comment:\"predicted h2o solubility (MI:2158): 1.46e-02 mg/mL [ALOGPS]\"\t-\t-\t-\t-";
        Row row3 = rowBuilder.createRow( imatinibLine2 );

        rscScore = rsc.calculateScore(row3);
        properties = rsc.getWeights();

        Assert.assertEquals(8, properties.size());
        Assert.assertEquals("A-C",rscScore);

        printProperties( properties );


    }


    private void printProperties( Properties properties ) {
        if ( properties != null ) {
            properties.list( System.out );
        }
    }

}
